{% extends "base.html" %}

{% block content %}
<div class="container">
  <div class="search-container">
    <form>
      <input type="search" placeholder="Search.." name="q" value="{{search_query}}"></input>
      <button type="submit">Search</button>
    </form>
  </div>
  {% if tags %}
  <div class="active-filters">
    <span>Filtered by tags: </span>
    {% for tag in tags.split(',') %}
    <span class="active-tag">{{tag}}</span>
    {% endfor %}
    <a href="/" class="clear-filters">Clear filters</a>
  </div>
  {% endif %}
  {% for bookmark in bookmarks %}
  <div class="bookmark">
    <div class="bookmark-header">
      <a href="{{bookmark.url}}">{{bookmark.title}}</a>
    </div>
    <div class="bookmark-description">
      <p>{{bookmark.description}}</p>
    </div>
    {% if bookmark.tags %}
    <div class="bookmark-tags">
      {% for tag in bookmark.tags %}
      {% if tag.strip() %}
      <a href="/?tags={{tag}}" class="tag-badge">{{tag}}</a>
      {% endif %}
      {% endfor %}
    </div>
    {% endif %}
    <div class="bookmark-timestamp">
      <p>{{bookmark.date_added}}<a href="/bookmarks/{{bookmark.id}}/edit" class="edit-link">EDIT</a><a href="/bookmarks/{{bookmark.id}}/archive" class="archive-link" onclick="return confirm('Archive this bookmark?') && fetch(this.href, {method: 'POST'}).then(() => location.reload())">ARCHIVE</a></p>
    </div>
  </div>
  {% endfor %}
<div class="bookmark-pagination">
  <a href="/?offset={{prev_offset}}&limit={{limit}}&tags={{tags}}&q={{search_query}}">prev</a>Page {{page_num}}<a href="/?offset={{next_offset}}&limit={{limit}}&tags={{tags}}&q={{search_query}}">next</a>
</div>
</div>
{% endblock %}
